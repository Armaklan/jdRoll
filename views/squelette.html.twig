<!DOCTYPE html>
<html lang="fr">
<head>
	<title>jdRoll</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="shortcut icon" type="image/x-icon" href="{{app.request.baseUrl}}/favicon.ico">

	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/bootstrap.min.css" type="text/css" media="all">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/bootstrap-responsive.min.css" type="text/css" media="all">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/bootstrap-fileupload.css" type="text/css" media="all">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/bootstrap-colorpicker.css" type="text/css" media="all">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/bootstrap-formhelpers.css" type="text/css" media="all">
    <link rel="stylesheet" href="{{app.request.baseUrl}}/css/datepicker.css" type="text/css" media="all">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/font-awesome.min.css">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/main.css" type="text/css" media="all">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/magicsuggest-1.3.0-min.css">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/bootstrap-editable.css">
	<link rel="stylesheet" href="{{app.request.baseUrl}}/css/jquery-ui.css" />

	<script type="text/javascript" src="{{app.request.baseUrl}}/js/jquery-1.9.1.min.js"> </script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/bootstrap.min.js"> </script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/jquery.shortcuts.min.js"> </script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/bootbox.min.js"> </script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/bootstrap-fileupload.min.js"> </script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/bootstrap-colorpicker.js"> </script>
    <script type="text/javascript" src="{{app.request.baseUrl}}/js/bootstrap-formhelpers-selectbox.js"> </script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/JDRollBootstrap-editable.js"></script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/jquery.form.js"></script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/magicsuggest-1.3.0-min.js"></script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/chat.js"></script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/JDRollFDP.js"></script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/jquery-ui.min.js"></script>
	<script type="text/javascript" src="{{app.request.baseUrl}}/js/JDRollEditableSelect.js"></script>
        <script type="text/javascript" src="{{app.request.baseUrl}}/js/notif.js"></script>
        <script type="text/javascript" src="{{app.request.baseUrl}}/js/draft.js"></script>
    <script type="text/javascript" src="{{app.request.baseUrl}}/js/bootstrap-datepicker.js"> </script>
	
    

  <script type="text/javascript" src="{{app.request.baseUrl}}/tinymce/tinymce.min.js"></script>

  <script>
        if (window.matchMedia("(min-width: 600px)").matches) {
          tinymce.init({
          selector: ".wysiwyg",
          plugins: [
             "link image lists preview hr insertdatetime",
             "table template textcolor fullscreen",
             "emoticons code spellchecker"
          ],
          browser_spellcheck : true,
          convert_urls: false,
          spellchecker_languages : "+French=fr",
          spellchecker_rpc_url : "{{app.request.baseUrl}}/tinymce/plugins/spellchecker/rpc.php",
          toolbar: "cut copy paste | styleselect removeformat | bold italic forecolor | alignleft aligncenter alignright alignjustify | hr | bullist numlist outdent indent | link image | preview fullscreen | emoticons private hide",
          style_formats: [
                          {title: 'Dialogue', inline: 'span', classes: 'dialogue', styles : {color : '#4488CC'}},
                          {title: 'Pensée', inline: 'span', classes: 'pensee', styles : {color : '#8844CC'}},
                          {title: 'Hrp', inline: 'span', classes: 'hrp', styles : {color : 'grey'}},
                          {title: 'Titre 1', block : 'h1'},
                          {title: 'Titre 2', block : 'h2'},
                          {title: 'Titre 3', block : 'h3'}
                      ],
          autosave_ask_before_unload: false,
				setup: function(editor) {
					editor.addButton('private', {
						text: 'Prv',
						icon: false,
						onclick: function() {
                            var content = tinyMCE.activeEditor.selection.getContent();
							editor.insertContent('[private]' + content + '[/private]');
						}
					});
					editor.addButton('hide', {
						text: 'Hid',
						icon: false,
						onclick: function() {
                            var content = tinyMCE.activeEditor.selection.getContent();
							editor.insertContent('[hide]' + content + '[/hide]');
						}
					});
				},
          min_height: 160
       });
    } else {
        tinymce.init({
              selector: ".wysiwyg",
              plugins: [
                 "link image lists preview hr insertdatetime",
                 "table template textcolor fullscreen",
                 "emoticons code"
              ],
              menubar : false,
              browser_spellcheck : true,
              convert_urls: false,
              toolbar: "paste | styleselect removeformat | bold italic | hr | link image | code",
              style_formats: [
                              {title: 'Dialogue', inline: 'span', classes: 'dialogue', styles : {color : '#4488CC'}},
                              {title: 'Pensée', inline: 'span', classes: 'pensee', styles : {color : '#8844CC'}},
                              {title: 'Hrp', inline: 'span', classes: 'hrp', styles : {color : 'grey'}},
                              {title: 'Titre 1', block : 'h1'},
                              {title: 'Titre 2', block : 'h2'},
                              {title: 'Titre 3', block : 'h3'}
                          ],
              autosave_ask_before_unload: false,
              min_height: 160,
              width: 300
           });
    }
 </script>


  <script type="text/javascript">



  </script>
  <script>
  function notifyMsg(msg) {
	  AlternativeTitle.titles = new Array("jdRoll", msg);
	  AlternativeTitle.delay = 1000;

	  function AlternativeTitle(){};

	  AlternativeTitle.currentIndex;

	  AlternativeTitle.init = function()
	      {
	      AlternativeTitle.currentIndex = 0;
	      setInterval(AlternativeTitle.change, AlternativeTitle.delay);
	      };

	  AlternativeTitle.change = function()
	      {
	      if(AlternativeTitle.currentIndex + 1 > AlternativeTitle.titles.length)
	          AlternativeTitle.currentIndex = 0;

	      document.title = AlternativeTitle.titles[AlternativeTitle.currentIndex];

	      AlternativeTitle.currentIndex++;
	      };

	  AlternativeTitle.init();
  }
</script>
	{% block specificHeader %}

	{% endblock %}
</head>
<body>

	<a name="top"></a>


    {{ render(url('menu')) }}

	<div class="container-fluid" style="margin-top: 4em;">

	    <div class="row-fluid">
	    	<div class="span9">
	    		{% block sidebar_large %}
                                {{ render(url('sidebar_std_large')) }}
                        {% endblock %}

          {% block precontent %}
          {% endblock %}
          <p></p>


              {% if app.request.baseUrl == "/jdRoll" %}
                  <div class="alert alert-error">
                  Merci d'utiliser la nouvelle URL : <a href="http://www.jdroll.org">http://www.jdroll.org</a> <br>
                  L'utilisation de l'ancien adresse peut entrainer des problèmes de compatibilités dans la gestion des images.
                  </div>
              {% endif %}

	    		{% block content %}
				    Content of the page...
				{% endblock %}
	    	</div>
	    </div>
	</div>

	<script>
		$('.iconeBtn').tooltip();
		$('.colorpicker').colorpicker();
	</script>

	{% block specificJs %}

	{% endblock %}

    <script>
    	function filterTable(idFilter, idTable) {
        	searchText = $(idFilter).val().toLowerCase();
			$(idTable + " tr ").each(function(i){
				currentSearchIndex = $(this).find('.filterIndex').val().toLowerCase();
				if(currentSearchIndex != "header") {
					if( currentSearchIndex.indexOf(searchText) > -1) {
						$(this).css("display", "");
					} else {
						$(this).css("display", "none");
					}
				}
			});
        }

        function onBtnDangerClick() {
            bootbox.confirm("L'action demandé est une action dangereuse (Suppression, Quitter une partie, ...). Etes-vous sur ? ", "Non", "Oui", function(confirmed) {
    		        if(confirmed) {
                            return true;
    		        } else {
                            return false;
                        }
            });
        }

        function selectAll(formName) {
            var checked = $(formName).find(".checkAll").is(':checked');
            $(formName).find('input[type=checkbox]').attr('checked', checked);
        }


        $(function () {
    		$(".collapserLink").click(function(e) {
    		    e.preventDefault();
    		    var sign = $(this).children('i');
    		    if(sign.hasClass('icon-chevron-sign-down')) {
                        sign.removeClass("icon-chevron-sign-down").addClass("icon-chevron-sign-up");
                    } else {
                        sign.removeClass("icon-chevron-sign-up").addClass("icon-chevron-sign-down");
                    }
    		});
    	});



    	$(function () {
    		$("a.btn-danger").click(function(e) {
    		    e.preventDefault();
    		    var location = $(this).attr('href');
    		    bootbox.confirm("L'action demandé est une action dangereuse (Suppression, Quitter une partie, ...). Etes-vous sur ? ", "Non", "Oui", function(confirmed) {
    		        if(confirmed) {
    		        window.location.replace(location);
    		        }
    		    });
    		});
    	});

        function alarm(joueur, campagne) {
            var statutAlarm = 0;
            if ($(".alarm-pj").hasClass("alarm-on") ) {
                $(".alarm-pj").removeClass("alarm-on");
                var statutAlarm = 0;
            } else {
                $(".alarm-pj").addClass("alarm-on");
                var statutAlarm = 1;
            }

            $.ajax({
                type: "POST",
                url: "{{ path('alarm') }}",
				data: {joueur: joueur, campagne: campagne, statut: statutAlarm},
                success: function(msg){},
                error: function(msg) {}
            });
        }

    </script>
    {% if (app.session.get('user') != null)  %}
	<div id="notificationCenter">
		{{ render(url('notifications')) }}
    	{% include('notification/ajax_notif_refresh.html.twig') %}
	</div>
    {% endif %}
    <a name="bottom"></a>

   	{% if app.session.get('user') != null %}
	{% endif %}
    {% include('uploader.html.twig') %}

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-41202193-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>

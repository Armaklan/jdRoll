{% extends "squelette_campagne.html.twig" %}

{% block content %}

	{% if (error != "") %}
	    <div class="alert alert-error">
	    	{{ error }}
	    </div>
    {% endif %}
    
    <div align="right">
	    <form class="form-search">
	    	<input type="text" id="searchText" onkeyup="filterTable('#searchText','#persoTable')"  class="input-medium search-query">
	    </form>
    </div>
    <table class="table table-striped table-hover" id="persoTable">
		<thead>
			<tr>
				<th width="10%">Avatar</th>
				<th width="60%">Nom du personnage</th>
				<th width="15%">Concept</th>
				<th width="15%">
					{% if is_mj %}
						<a href="{{ path('perso_pnj_add', {campagne_id: campagne_id}) }}" class="btn btn-primary iconeBtn sidebarBtn" title="Ajouter un PNJ"><i class="icon-plus"></i></a>
					{% endif %}
					<input type="hidden" class="filterIndex" value="HEADER">
				</th>
			</tr>
		</thead>
		<tbody>
			{% for perso in persos %}
				{% if is_mj or perso.statut == 0 %}
				{% set colorStyle = "" %}
				{% if perso.statut == 2 %} 
					 {% set colorStyle = "style=\"background-color: #DDC7B7\"" %}
				{% endif %}
				<tr>
					<td {% autoescape false %} {{colorStyle}} {% endautoescape %}><img src="{{ perso.avatar }}" width="70%"/></td>
					<td {% autoescape false %} {{colorStyle}} {% endautoescape %}>
						{% if is_mj %}
							<a href="{{ path('perso_edit_mj', {campagne_id: campagne_id, perso_id: perso.id}) }}">{{ perso.name }}</a>
						{% else %}
							<a href="{{ path('perso_view', {campagne_id: campagne_id, perso_id: perso.id}) }}">{{ perso.name }}</a>
						{% endif %}
					</td>
					<td {% autoescape false %} {{colorStyle}} {% endautoescape %}>{{ perso.concept }}</td>
					<td {% autoescape false %} {{colorStyle}} {% endautoescape %}>{% if is_mj %}
							<a href="{{ path('perso_edit_mj', {campagne_id: campagne_id, perso_id: perso.id}) }}" class="btn iconeBtn sidebarBtn" title="Feuille de personnage"><i class="icon-tasks"></i></a>
							<a href="{{ path('attach', {campagne_id: campagne_id, perso_id: perso.id}) }}" class="btn btn-danger iconeBtn sidebarBtn" title="Transférer"><i class="icon-share-alt"></i></a>
							<a href="{{ path('perso_pnj_del', {campagne_id: campagne_id, perso_id: perso.id}) }}" class="btn btn-danger iconeBtn sidebarBtn" title="Supprimer le personnage"><i class="icon-remove-sign"></i></a>
							
							
						{% else %}
							<a href="{{ path('perso_view', {campagne_id: campagne_id, perso_id: perso.id}) }}" class="btn iconeBtn sidebarBtn" title="Plus de détail..."><i class="icon-search"></i></a>
						{% endif %}
						<input type="hidden" class="filterIndex" value="{{ perso.name }}{{ perso.publicDescription }}{{ perso.concept }}">
					</td>
				</tr>
				{% endif %}
			{% endfor %}
		</tbody>
		</table>

{% endblock %}
